<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data Analyses • asds2024.nils.practical</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Analyses">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">asds2024.nils.practical</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/get-started.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data.html">Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyses.html">Analyses</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/presentation.html">Mid-Term Presentation</a></li>
    <li><a class="dropdown-item" href="../articles/article.html">Final Report</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data Analyses</h1>
            
      

      <div class="d-none name"><code>analyses.Rmd</code></div>
    </div>

    
    
<p>Packages used for analyses, grouped by application:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># general data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualization</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># linear models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ElasticNet</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># random and mixed-effects linear models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># clustering</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mhahsler/dbscan" class="external-link">dbscan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/" class="external-link">mclust</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dynamic time warping</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dynamictimewarping.github.io/" class="external-link">dtw</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># data and util functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nils-s.github.io/cas-asds-practical/">asds2024.nils.practical</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for reproducible results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The final module of the Certificate of Advanced Studies in Advanced
Statistical Data Science (CAS ASDS) is a practical project. The topic of
the project can be freely chosen by the students, e.g. using data from
their work environment or from elsewhere.</p>
<p>The data I chose for my final project is data collected from road
bike trips during the years 2018 to 2023. Data was collected using a
GPS-enabled bike computer, with complementary sensors for heart rate,
cadence, and speed data. In total, the preprocessed data comprises
approximately 160000 data points, collected during 157 trips. The actual
number of trips during those seasons was higher, however, due to a data
corruption in the bike computer’s memory, an unknown number of trip
recordings was lost. The following diagram shows the number of tracks
for each year in the data set, suggesting that a data block (or data
blocks) containing records for 2022 and 2023 was lost.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Number of Tracks"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="analyses_files/figure-html/fig-tracks-per-year-1.png" alt="\label{fig-tracks-per-year}Available trip data by year" width="384"><p class="caption">
Available trip data by year
</p>
</div>
<p>The following image shows the geographic component of the available
data on a map, with the tracks in red. Routes driven more frequently
appear more saturated, rarely-driven routes appear lighter (e.g. the
route to lake Thun only appears once in the data set).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">be_fr</span> <span class="op">&lt;-</span> <span class="va">swiss_cantons</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">KTNR</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="co"># 2 = BE, 10 = FR</span></span>
<span><span class="va">be_fr_lakes</span> <span class="op">&lt;-</span> <span class="va">swiss_lakes</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Biel|Brienz|Gruyère|Murten|Neuchâtel|Thun"</span>, <span class="va">GMDNAME</span><span class="op">)</span><span class="op">)</span> <span class="co"># only show lakes named after these towns</span></span>
<span></span>
<span><span class="va">track_linestrings</span> <span class="op">&lt;-</span> <span class="va">track_details</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">latitude</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">longitude</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="st">"WGS84"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># EPSG 4326 = WGS-84</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">2056</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># EPSG 2056 = CH-1903+/LV95</span></span>
<span>  <span class="fu"><a href="../reference/to_linestrings.html">to_linestrings</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">track_linestrings</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">be_fr</span>, fill <span class="op">=</span> <span class="st">"#f0f0f0"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">be_fr_lakes</span>, fill <span class="op">=</span> <span class="st">"#0080ff"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.25</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_scale.html" class="external-link">annotation_scale</a></span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"br"</span>,</span>
<span>    height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    width_hint <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_north_arrow.html" class="external-link">annotation_north_arrow</a></span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"tr"</span>,</span>
<span>    width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    pad_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    pad_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="va">north_arrow_fancy_orienteering</span>,</span>
<span>    which_north <span class="op">=</span> <span class="st">"true"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="analyses_files/figure-html/fig-tracks-map-1.png" alt="Geographic track data (in red) on a map of cantons Berne and Fribourg" width="384"><p class="caption">
Geographic track data (in red) on a map of cantons Berne and Fribourg
</p>
</div>
<p>Since the data was not collected for the purpose of this project,
i.e. it is not data from a controlled experiment, it is not as
well-formed as would be desirable for an ideal analysis. Instead, the
project is an exploratory analysis of available data.</p>
</div>
<div class="section level2">
<h2 id="analyses">Analyses<a class="anchor" aria-label="anchor" href="#analyses"></a>
</h2>
<p>The initial raw data has been pre-processed for inclusion in the
package (see <code><a href="../articles/data.html">vignette("data")</a></code>), however, first cursory
analyses in an interactive session still showed some unexpected results.
Some more cleaning was therefore done first.</p>
<div class="section level3">
<h3 id="data-cleaning">Data Cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<p>Despite the initial data cleanup, there is still invalid data for
track 157, which seems to have been caused by some sort of GPS
hiccup:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">track_details</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks</span><span class="op">[</span><span class="fl">157</span>,<span class="op">]</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">training_time_absolute_s</span> <span class="op">/</span> <span class="fl">100</span>, y <span class="op">=</span> <span class="va">distance_absolute_m</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Training Time (s)"</span>, y <span class="op">=</span> <span class="st">"Distance (km)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Track 157: Distance Over Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/track157-raw-1.png" width="384" style="display: block; margin: auto;"></p>
<p>This seems easy enough to fix, though, since it appears that only the
<code>distance_absolute_m</code> values for that track seem to have a
sudden jump. Knowing the total length of that track (slightly more than
40 km), and seeing that there seems to be only one corrupted data point
(subsequent points seem to continue normally), the fix is simply to
subtract the jump from all points with a distance &gt; 90 km. Assuming
the points between which the jump occurs are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>,
the height of the jump is assumed to be
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">jump height</mtext><mo>=</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>δ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{jump height} = d(p_2) - d(p_1) - \delta(p_2)
</annotation></semantics></math> (where, for a given point,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">d(\cdot)</annotation></semantics></math>
means <code>distance_absolute_m</code>, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\delta(\cdot)</annotation></semantics></math>
means <code>distance_m</code>). In other words, the true difference in
<code>distance_absolute_m</code> between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>1</mn></msub><annotation encoding="application/x-tex">p_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>
is assumed to be the <code>distance_m</code> value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>
(i.e. the distance travelled during that segment). Any excess difference
is assumed to be erroneous, and is subtracted from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mn>2</mn></msub><annotation encoding="application/x-tex">p_2</annotation></semantics></math>
and all subsequent points.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected_track_details</span> <span class="op">&lt;-</span> <span class="va">track_details</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    correction <span class="op">=</span> <span class="va">distance_absolute_m</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">distance_absolute_m</span>, default <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">-</span> <span class="va">distance_m</span>,</span>
<span>    needs_correction <span class="op">=</span> <span class="op">(</span><span class="va">distance_absolute_m</span> <span class="op">&gt;</span> <span class="fl">90000</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks</span><span class="op">[</span><span class="fl">157</span>,<span class="op">]</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    corrected_distance_absolute_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">needs_correction</span>, <span class="va">distance_absolute_m</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">correction</span><span class="op">)</span>, <span class="va">distance_absolute_m</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">corrected_tracks</span> <span class="op">&lt;-</span> <span class="va">corrected_track_details</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    distance_absolute_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">needs_correction</span>, <span class="va">corrected_distance_absolute_m</span>, <span class="va">distance_absolute_m</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/summarize_tracks.html">summarize_tracks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The resulting distance plot then appears correct:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected_track_details</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks</span><span class="op">[</span><span class="fl">157</span>,<span class="op">]</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">training_time_absolute_s</span> <span class="op">/</span> <span class="fl">100</span>, y <span class="op">=</span> <span class="va">corrected_distance_absolute_m</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Training Time (s)"</span>, y <span class="op">=</span> <span class="st">"Distance (km)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Track 157: Corrected Distance Over Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/track157-corrected-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The corrected data is used for all further analyses.</p>
</div>
<div class="section level3">
<h3 id="linear-models">Linear Models<a class="anchor" aria-label="anchor" href="#linear-models"></a>
</h3>
<p>First, let’s try to fit linear models using different predictors, to
get an idea which predictors might influence the average track
speed.</p>
<div class="section level4">
<h4 id="temperature-effects">Temperature Effects<a class="anchor" aria-label="anchor" href="#temperature-effects"></a>
</h4>
<p>The first idea is to look for a temperature effect, i.e. does
temperature influence the average speed? Intuitively, there is an
optimum temperature, and lower and higher temperatures should result in
lower performance.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_temperature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">temperature_c</span>, data <span class="op">=</span> <span class="va">corrected_tracks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_temperature</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ temperature_c, data = corrected_tracks)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -4.1644 -0.8346  0.0939  0.8662  2.8922 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   28.013494   0.573848  48.817   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; temperature_c -0.006994   0.027551  -0.254      0.8    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.296 on 155 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0004156,  Adjusted R-squared:  -0.006033 </span></span>
<span><span class="co">#&gt; F-statistic: 0.06444 on 1 and 155 DF,  p-value: 0.7999</span></span></code></pre></div>
<p>As can be seen from the model, temperature does not have a
statistically significant influence (the p-Value is 0.8, i.e. nowhere
near the 0.05 that would suggest significance). However, the estimated
effect is very small, so there might be some very small effect that
would need much more data to reliably detect.</p>
<p>Another factor might be that a straight line is not well suited to
describe the effect, since the assumed optimum temperature would mean
that e.g. a quadratic function could be a better fit for the data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_temp_ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">temperature_c</span>, df <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">corrected_tracks</span><span class="op">)</span></span>
<span><span class="va">fit_temp_bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/bs.html" class="external-link">bs</a></span><span class="op">(</span><span class="va">temperature_c</span>, df <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">corrected_tracks</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp_pred_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">10.0</span>, to <span class="op">=</span> <span class="fl">32.5</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">temp_pred_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>temperature_c <span class="op">=</span> <span class="va">temp_pred_grid</span><span class="op">)</span></span>
<span><span class="va">fit_temp_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>speed_km_h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_temperature</span>, <span class="va">temp_pred_data</span><span class="op">)</span>, temperature_c <span class="op">=</span> <span class="va">temp_pred_grid</span><span class="op">)</span></span>
<span><span class="va">fit_temp_ns_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>speed_km_h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_temp_ns</span>, <span class="va">temp_pred_data</span><span class="op">)</span>, temperature_c <span class="op">=</span> <span class="va">temp_pred_grid</span><span class="op">)</span></span>
<span><span class="va">fit_temp_bs_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>speed_km_h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_temp_bs</span>, <span class="va">temp_pred_data</span><span class="op">)</span>, temperature_c <span class="op">=</span> <span class="va">temp_pred_grid</span><span class="op">)</span></span>
<span><span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature_c</span>, y <span class="op">=</span> <span class="va">speed_km_h</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fit_temp_pred</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fit_temp_ns_pred</span>, color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fit_temp_bs_pred</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Temperature (°C)"</span>, y <span class="op">=</span> <span class="st">"Speed (km/h)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/temperature-model-splines-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The B-spline (blue) seems to fit slightly better, the natural cubic
spline (green) would not fit well for lower temperatures. However,
neither of the spline models has a significant parameter besides the
intercept, so they are not viable either.</p>
<p>Thus, temperature seems to have either not have any effect, or the
effect is so small that a lot more data would be required to reliably
detect it.</p>
</div>
<div class="section level4">
<h4 id="effects-of-track-length-inclination-and-heart-rate">Effects of Track Length, Inclination, and Heart Rate<a class="anchor" aria-label="anchor" href="#effects-of-track-length-inclination-and-heart-rate"></a>
</h4>
<p>Another model that seems rather intuitive is to use a track’s
distance, average inclination, and average heart rate to model the
average speed:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_dihr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">distance_km</span> <span class="op">+</span> <span class="va">avg_inclination</span> <span class="op">+</span> <span class="va">avg_hr_bpm</span>, data <span class="op">=</span> <span class="va">corrected_tracks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_dihr</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ distance_km + avg_inclination + avg_hr_bpm, </span></span>
<span><span class="co">#&gt;     data = corrected_tracks)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -3.04856 -0.47765  0.08545  0.51618  2.38627 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)      2.193e+01  1.272e+00  17.243  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; distance_km     -7.525e-03  3.852e-03  -1.954   0.0526 .  </span></span>
<span><span class="co">#&gt; avg_inclination -4.206e+02  3.931e+01 -10.701  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; avg_hr_bpm       7.484e-02  8.444e-03   8.863 1.87e-15 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8418 on 153 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.5839, Adjusted R-squared:  0.5757 </span></span>
<span><span class="co">#&gt; F-statistic: 71.55 on 3 and 153 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>This model shows that inclination and heart rate are highly
significant, whereas the distance is not. The estimated coefficients
indicate the expected relationships:</p>
<ul>
<li>steeper tracks (i.e. higher average inclination) have a lower
average speed</li>
<li>a higher effort (i.e. a higher average heart rate) leads to a higher
average speed</li>
<li>longer distances lead to a lower speed (however, this is
relationship is not statistically significant)</li>
</ul>
<p>Furthermore, a model based on these three predictors can account for
almost 60% of the observed variance in the data.</p>
<p>Evaluating the model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_dihr</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/basic-model-plots-1.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/basic-model-plots-2.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/basic-model-plots-3.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/basic-model-plots-4.png" width="384" style="display: block; margin: auto;"></p>
<p>The model has some obvious weaknesses (residuals at the lower and
higher ends of the observed speed spectrum are not as close to zero as
they should be, and one track (number 2) has a relatively large residual
error and leverage), but overall it seems not too bad.</p>
</div>
<div class="section level4">
<h4 id="effect-of-previous-training-session">Effect of Previous Training Session<a class="anchor" aria-label="anchor" href="#effect-of-previous-training-session"></a>
</h4>
<p>Another potential factor to influence average speed is the previous
training: one could reasonably expect that a training session too
shortly after another one would negatively affect speed for the second
training. On the other hand, too long of a break between trainings
should probably also negatively affect average speed (assuming that a
positive effect of a training is slowly lost over time).</p>
<p>To validate this hypothesis, the previous model using distance,
inclination, and heart rate can be extended with the number of days
since the last training, and the previous training’s distance,
inclination and average heart rate:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected_tracks</span> <span class="op">&lt;-</span> <span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    previous_training_date <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    days_since_previous_training <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">previous_training_date</span>, units <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">augmented_tracks</span> <span class="op">&lt;-</span> <span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">corrected_tracks</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">previous_training_date</span> <span class="op">==</span> <span class="va">date</span><span class="op">)</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"_previous_training"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">distance_km</span> <span class="op">+</span> <span class="va">avg_inclination</span> <span class="op">+</span> <span class="va">avg_hr_bpm</span> <span class="op">+</span> <span class="va">days_since_previous_training</span> <span class="op">+</span> <span class="va">distance_km_previous_training</span> <span class="op">+</span> <span class="va">avg_inclination_previous_training</span> <span class="op">+</span> <span class="va">avg_hr_bpm_previous_training</span>, data <span class="op">=</span> <span class="va">augmented_tracks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_pt</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ distance_km + avg_inclination + avg_hr_bpm + </span></span>
<span><span class="co">#&gt;     days_since_previous_training + distance_km_previous_training + </span></span>
<span><span class="co">#&gt;     avg_inclination_previous_training + avg_hr_bpm_previous_training, </span></span>
<span><span class="co">#&gt;     data = augmented_tracks)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.80543 -0.51481  0.06608  0.49832  2.35074 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                        2.182e+01  1.367e+00  15.967  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; distance_km                       -1.127e-02  4.125e-03  -2.732  0.00707 ** </span></span>
<span><span class="co">#&gt; avg_inclination                   -4.224e+02  3.935e+01 -10.735  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; avg_hr_bpm                         7.834e-02  1.219e-02   6.427 1.68e-09 ***</span></span>
<span><span class="co">#&gt; days_since_previous_training      -3.606e-03  1.626e-03  -2.218  0.02811 *  </span></span>
<span><span class="co">#&gt; distance_km_previous_training      9.850e-03  4.184e-03   2.354  0.01989 *  </span></span>
<span><span class="co">#&gt; avg_inclination_previous_training -5.667e+01  3.871e+01  -1.464  0.14534    </span></span>
<span><span class="co">#&gt; avg_hr_bpm_previous_training       4.168e-04  1.207e-02   0.035  0.97250    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8206 on 148 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6152, Adjusted R-squared:  0.597 </span></span>
<span><span class="co">#&gt; F-statistic:  33.8 on 7 and 148 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>In this model, the days since the previous training, and the previous
training’s distance are significant factors, the previous training’s
inclination and average heart rate are not. This seems counterintuitive,
considering in the previous, simpler model (the one without considering
the previous training), the distance was not a significant factor, and
inclination and heart rate were highly significant. In this extended
model, inclination and heart rate are still significant for the current
training, but are not significant for the previous training.
Furthermore, both the current and the previous training’s distance is
now a significant predictor.</p>
<p>While some of the additional predictors are significant, the extended
model only explains about an additional three percentage points of
variance in the data. Additionally, the diagnostic plots look much worse
than for the simpler model:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_pt</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/prev-training-model-plot-1.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/prev-training-model-plot-2.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/prev-training-model-plot-3.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/prev-training-model-plot-4.png" width="384" style="display: block; margin: auto;"></p>
<p>There are now data points with higher leverage than before which also
have larger residuals, the QQ-plot shows a larger deviation from the
diagonal at the low end, and the residuals plot looks worse as well.
Overall, taking the previous training into account seems to not be
worthwile: the model only explains slightly more variance, at the cost
of significantly worse diagnostics.</p>
</div>
<div class="section level4">
<h4 id="effects-of-training-season">Effects of Training Season<a class="anchor" aria-label="anchor" href="#effects-of-training-season"></a>
</h4>
<p>Since the data is actually a time series, it seems likely that there
is a time-based aspect to a potential training effect. In order to take
this into consideration for a linear model, the month and calendar week
were tried as predictors.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks_speed_month</span> <span class="op">&lt;-</span> <span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">speed_km_h</span>, <span class="va">month</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">fit_month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">month</span>, data <span class="op">=</span> <span class="va">tracks_speed_month</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_month</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ month, data = tracks_speed_month)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.9110 -0.8636  0.1374  0.7991  3.0588 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  26.9297     1.2843  20.969   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; month4        1.2657     1.3293   0.952    0.343    </span></span>
<span><span class="co">#&gt; month5        1.5226     1.3160   1.157    0.249    </span></span>
<span><span class="co">#&gt; month6        0.7667     1.3042   0.588    0.558    </span></span>
<span><span class="co">#&gt; month7        0.6297     1.3087   0.481    0.631    </span></span>
<span><span class="co">#&gt; month8        0.8073     1.3048   0.619    0.537    </span></span>
<span><span class="co">#&gt; month9        1.1544     1.3119   0.880    0.380    </span></span>
<span><span class="co">#&gt; month10       0.7003     1.3470   0.520    0.604    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.284 on 149 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0568, Adjusted R-squared:  0.01249 </span></span>
<span><span class="co">#&gt; F-statistic: 1.282 on 7 and 149 DF,  p-value: 0.263</span></span></code></pre></div>
<p>Apparently, later months do not have a significantly different
average speed than the first month in the data (i.e. March). Using
Helmert contrasts instead of the (default) treatment contrasts to
compare later months to preceding months (instead of comparing to the
March baseline), there are again no significant results:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">tracks_speed_month</span><span class="op">$</span><span class="va">month</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"contr.helmert"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">month</span>, data <span class="op">=</span> <span class="va">tracks_speed_month</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ month, data = tracks_speed_month)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.9110 -0.8636  0.1374  0.7991  3.0588 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 27.78555    0.18769 148.043   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; month1       0.63286    0.66467   0.952    0.343    </span></span>
<span><span class="co">#&gt; month2       0.29659    0.24135   1.229    0.221    </span></span>
<span><span class="co">#&gt; month3      -0.04069    0.12675  -0.321    0.749    </span></span>
<span><span class="co">#&gt; month4      -0.05181    0.08538  -0.607    0.545    </span></span>
<span><span class="co">#&gt; month5      -0.00494    0.06051  -0.082    0.935    </span></span>
<span><span class="co">#&gt; month6       0.04605    0.05106   0.902    0.369    </span></span>
<span><span class="co">#&gt; month7      -0.02222    0.05695  -0.390    0.697    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.284 on 149 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0568, Adjusted R-squared:  0.01249 </span></span>
<span><span class="co">#&gt; F-statistic: 1.282 on 7 and 149 DF,  p-value: 0.263</span></span></code></pre></div>
<p>Maybe, however, the training effect lies in the fact that later in
the season the average track is longer/steeper/more exhausting in
general?</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">distance_km</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="st">"#0000f0"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Month"</span>, y <span class="op">=</span> <span class="st">"Distance (km)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Track Length by Month"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/distances-by-month-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Overall, and with the exception of March (for which there is only one
data point), at least the median length of the tracks seems to follow a
pattern of longer tracks during the summer, and shorter tracks at the
beginning and end of the season. This might be related to fitness level,
and/or to the weather (temperature, precipitation) and available
daylight (longer days in the summer months, shorter days in spring and
fall).</p>
<p>Thus, let’s try a model taking into account the month, as well as the
distance, inclination, and heart rate, and their interaction with the
month:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_month_and_more</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">distance_km</span> <span class="op">+</span> <span class="va">avg_hr_bpm</span> <span class="op">+</span> <span class="va">avg_inclination</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">corrected_tracks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_month_and_more</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ as.factor(month(date)) * (distance_km + </span></span>
<span><span class="co">#&gt;     avg_hr_bpm + avg_inclination), data = corrected_tracks)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.18792 -0.40704  0.06077  0.41516  1.79607 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: (3 not defined because of singularities)</span></span>
<span><span class="co">#&gt;                                            Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)                               2.422e+01  4.299e+00   5.634 1.07e-07</span></span>
<span><span class="co">#&gt; as.factor(month(date))4                   1.401e+01  7.179e+00   1.951  0.05321</span></span>
<span><span class="co">#&gt; as.factor(month(date))5                   5.452e+00  6.390e+00   0.853  0.39518</span></span>
<span><span class="co">#&gt; as.factor(month(date))6                  -8.583e+00  4.885e+00  -1.757  0.08127</span></span>
<span><span class="co">#&gt; as.factor(month(date))7                  -8.261e+00  5.284e+00  -1.564  0.12040</span></span>
<span><span class="co">#&gt; as.factor(month(date))8                  -3.090e+00  5.144e+00  -0.601  0.54910</span></span>
<span><span class="co">#&gt; as.factor(month(date))9                  -3.777e+00  5.314e+00  -0.711  0.47846</span></span>
<span><span class="co">#&gt; as.factor(month(date))10                  9.444e-01  1.118e+00   0.845  0.39987</span></span>
<span><span class="co">#&gt; distance_km                               9.491e-03  3.007e-02   0.316  0.75282</span></span>
<span><span class="co">#&gt; avg_hr_bpm                                3.443e-02  3.118e-02   1.104  0.27154</span></span>
<span><span class="co">#&gt; avg_inclination                          -2.591e+02  1.093e+02  -2.371  0.01921</span></span>
<span><span class="co">#&gt; as.factor(month(date))4:distance_km      -5.165e-02  3.450e-02  -1.497  0.13681</span></span>
<span><span class="co">#&gt; as.factor(month(date))5:distance_km      -2.113e-02  3.532e-02  -0.598  0.55074</span></span>
<span><span class="co">#&gt; as.factor(month(date))6:distance_km      -4.167e-03  3.127e-02  -0.133  0.89417</span></span>
<span><span class="co">#&gt; as.factor(month(date))7:distance_km      -2.269e-02  3.081e-02  -0.737  0.46274</span></span>
<span><span class="co">#&gt; as.factor(month(date))8:distance_km      -1.204e-02  3.098e-02  -0.389  0.69826</span></span>
<span><span class="co">#&gt; as.factor(month(date))9:distance_km      -3.563e-02  3.284e-02  -1.085  0.27999</span></span>
<span><span class="co">#&gt; as.factor(month(date))10:distance_km             NA         NA      NA       NA</span></span>
<span><span class="co">#&gt; as.factor(month(date))4:avg_hr_bpm       -6.154e-02  5.019e-02  -1.226  0.22238</span></span>
<span><span class="co">#&gt; as.factor(month(date))5:avg_hr_bpm       -7.934e-03  4.438e-02  -0.179  0.85839</span></span>
<span><span class="co">#&gt; as.factor(month(date))6:avg_hr_bpm        1.045e-01  3.699e-02   2.824  0.00550</span></span>
<span><span class="co">#&gt; as.factor(month(date))7:avg_hr_bpm        7.897e-02  3.694e-02   2.138  0.03443</span></span>
<span><span class="co">#&gt; as.factor(month(date))8:avg_hr_bpm        5.322e-02  3.585e-02   1.484  0.14020</span></span>
<span><span class="co">#&gt; as.factor(month(date))9:avg_hr_bpm        3.792e-02  3.807e-02   0.996  0.32108</span></span>
<span><span class="co">#&gt; as.factor(month(date))10:avg_hr_bpm              NA         NA      NA       NA</span></span>
<span><span class="co">#&gt; as.factor(month(date))4:avg_inclination  -1.792e+02  1.718e+02  -1.043  0.29875</span></span>
<span><span class="co">#&gt; as.factor(month(date))5:avg_inclination  -2.062e+02  1.590e+02  -1.297  0.19707</span></span>
<span><span class="co">#&gt; as.factor(month(date))6:avg_inclination  -4.468e+02  1.669e+02  -2.677  0.00841</span></span>
<span><span class="co">#&gt; as.factor(month(date))7:avg_inclination  -1.110e+02  1.336e+02  -0.831  0.40770</span></span>
<span><span class="co">#&gt; as.factor(month(date))8:avg_inclination  -2.608e+02  1.321e+02  -1.974  0.05057</span></span>
<span><span class="co">#&gt; as.factor(month(date))9:avg_inclination   9.679e+01  1.685e+02   0.575  0.56663</span></span>
<span><span class="co">#&gt; as.factor(month(date))10:avg_inclination         NA         NA      NA       NA</span></span>
<span><span class="co">#&gt;                                             </span></span>
<span><span class="co">#&gt; (Intercept)                              ***</span></span>
<span><span class="co">#&gt; as.factor(month(date))4                  .  </span></span>
<span><span class="co">#&gt; as.factor(month(date))5                     </span></span>
<span><span class="co">#&gt; as.factor(month(date))6                  .  </span></span>
<span><span class="co">#&gt; as.factor(month(date))7                     </span></span>
<span><span class="co">#&gt; as.factor(month(date))8                     </span></span>
<span><span class="co">#&gt; as.factor(month(date))9                     </span></span>
<span><span class="co">#&gt; as.factor(month(date))10                    </span></span>
<span><span class="co">#&gt; distance_km                                 </span></span>
<span><span class="co">#&gt; avg_hr_bpm                                  </span></span>
<span><span class="co">#&gt; avg_inclination                          *  </span></span>
<span><span class="co">#&gt; as.factor(month(date))4:distance_km         </span></span>
<span><span class="co">#&gt; as.factor(month(date))5:distance_km         </span></span>
<span><span class="co">#&gt; as.factor(month(date))6:distance_km         </span></span>
<span><span class="co">#&gt; as.factor(month(date))7:distance_km         </span></span>
<span><span class="co">#&gt; as.factor(month(date))8:distance_km         </span></span>
<span><span class="co">#&gt; as.factor(month(date))9:distance_km         </span></span>
<span><span class="co">#&gt; as.factor(month(date))10:distance_km        </span></span>
<span><span class="co">#&gt; as.factor(month(date))4:avg_hr_bpm          </span></span>
<span><span class="co">#&gt; as.factor(month(date))5:avg_hr_bpm          </span></span>
<span><span class="co">#&gt; as.factor(month(date))6:avg_hr_bpm       ** </span></span>
<span><span class="co">#&gt; as.factor(month(date))7:avg_hr_bpm       *  </span></span>
<span><span class="co">#&gt; as.factor(month(date))8:avg_hr_bpm          </span></span>
<span><span class="co">#&gt; as.factor(month(date))9:avg_hr_bpm          </span></span>
<span><span class="co">#&gt; as.factor(month(date))10:avg_hr_bpm         </span></span>
<span><span class="co">#&gt; as.factor(month(date))4:avg_inclination     </span></span>
<span><span class="co">#&gt; as.factor(month(date))5:avg_inclination     </span></span>
<span><span class="co">#&gt; as.factor(month(date))6:avg_inclination  ** </span></span>
<span><span class="co">#&gt; as.factor(month(date))7:avg_inclination     </span></span>
<span><span class="co">#&gt; as.factor(month(date))8:avg_inclination  .  </span></span>
<span><span class="co">#&gt; as.factor(month(date))9:avg_inclination     </span></span>
<span><span class="co">#&gt; as.factor(month(date))10:avg_inclination    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.7615 on 128 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7151, Adjusted R-squared:  0.6528 </span></span>
<span><span class="co">#&gt; F-statistic: 11.48 on 28 and 128 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Due to the dummy-coded month variable and the interactions, there are
now a lot more parameters, only few of which are significant.
Furthermore, the interactions with the October-level of the month
variable produce <code>NA</code>s, suggesting multicollinearity or some
other problem.</p>
<p>The model now explains about 71% of the variance in the data,
however, due to the model complexity, and the large number of
non-significant parameters, it appears dubious whether the model is
appropriate.</p>
<p>The diagnostic plots, on the other hand, don’t look too bad (though
worse than those of the simpler model using just distance, inclination,
and heart rate):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_month_and_more</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/month-interactions-model-plot-1.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/month-interactions-model-plot-2.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/month-interactions-model-plot-3.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/month-interactions-model-plot-4.png" width="384" style="display: block; margin: auto;"></p>
<p>Trying the same thing with higher temporal resolution (using calendar
week instead of month) is pointless, though:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html" class="external-link">isoweek</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">distance_km</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.25</span>, color <span class="op">=</span> <span class="st">"#0000f0"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Calendar Week"</span>, y <span class="op">=</span> <span class="st">"Distance (km)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Track Length by Calendar Week"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/distances-by-calendar-week-1.png" width="384" style="display: block; margin: auto;"></p>
<p>There are now a lot more factor levels, and correspondingly fewer
data points per level, so fitting a model in the same way as for month
just results in a model with lots of non-significant parameters:</p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ as.factor(isoweek(date)) * (distance_km + </span></span>
<span><span class="co">#&gt;     avg_hr_bpm + avg_inclination), data = corrected_tracks)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -1.9400 -0.2377  0.0000  0.1475  2.1459 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: (15 not defined because of singularities)</span></span>
<span><span class="co">#&gt;                                              Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)                                 1.783e+01  9.223e+00   1.933</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))14                  5.127e-01  5.991e+00   0.086</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))15                  4.730e+01  2.201e+02   0.215</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))16                  6.872e+01  2.573e+01   2.671</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))17                  8.307e+00  3.011e+01   0.276</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))18                 -1.559e+02  2.703e+02  -0.577</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))19                  3.307e+01  5.343e+01   0.619</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))21                  8.707e+00  1.115e+01   0.781</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))22                  1.745e+00  1.091e+01   0.160</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))23                 -8.769e-01  1.183e+01  -0.074</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))24                  9.441e-01  1.003e+01   0.094</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))25                 -2.428e+00  1.210e+01  -0.201</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))26                 -1.566e+01  1.218e+01  -1.286</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))27                  3.127e+01  1.841e+02   0.170</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))28                 -4.288e+00  1.119e+01  -0.383</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))29                 -8.458e+00  1.112e+01  -0.760</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))30                 -1.976e+00  1.248e+01  -0.158</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))31                  8.720e+00  1.027e+01   0.849</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))32                  3.753e+00  1.064e+01   0.353</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))33                 -4.268e+00  1.301e+01  -0.328</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))34                  9.199e-01  1.048e+01   0.088</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))35                  3.831e+00  4.188e+01   0.091</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))36                  4.993e+00  2.165e+01   0.231</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))37                  1.808e+01  2.441e+01   0.741</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))38                 -6.360e+00  6.210e+01  -0.102</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))39                 -1.552e+01  1.619e+01  -0.959</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))40                  1.379e+01  1.898e+01   0.727</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))41                 -1.676e+00  1.078e+01  -0.155</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))43                  7.124e-01  1.497e+00   0.476</span></span>
<span><span class="co">#&gt; distance_km                                 1.894e-03  1.898e-01   0.010</span></span>
<span><span class="co">#&gt; avg_hr_bpm                                  8.325e-02  5.184e-02   1.606</span></span>
<span><span class="co">#&gt; avg_inclination                            -3.201e+02  1.609e+02  -1.990</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))14:distance_km             NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))15:distance_km     -1.519e-01  1.404e+00  -0.108</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))16:distance_km      7.010e-01  4.406e-01   1.591</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))17:distance_km     -2.736e-02  1.931e-01  -0.142</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))18:distance_km      6.243e+00  1.063e+01   0.587</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))19:distance_km      6.980e-01  7.662e-01   0.911</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))21:distance_km     -5.726e-03  1.916e-01  -0.030</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))22:distance_km     -2.839e-03  1.907e-01  -0.015</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))23:distance_km      2.902e-03  1.909e-01   0.015</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))24:distance_km     -7.468e-03  1.918e-01  -0.039</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))25:distance_km     -2.234e-02  1.949e-01  -0.115</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))26:distance_km     -8.857e-04  1.912e-01  -0.005</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))27:distance_km      4.921e-01  2.727e+00   0.180</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))28:distance_km     -1.889e-03  1.915e-01  -0.010</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))29:distance_km     -2.818e-02  1.902e-01  -0.148</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))30:distance_km     -2.480e-02  1.905e-01  -0.130</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))31:distance_km     -3.739e-03  1.900e-01  -0.020</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))32:distance_km     -8.034e-03  1.904e-01  -0.042</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))33:distance_km     -1.355e-02  1.906e-01  -0.071</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))34:distance_km      1.575e-02  1.901e-01   0.083</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))35:distance_km      3.925e-02  4.197e-01   0.094</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))36:distance_km     -1.310e-02  1.916e-01  -0.068</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))37:distance_km      1.773e-01  3.463e-01   0.512</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))38:distance_km     -1.810e-01  6.844e-01  -0.264</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))39:distance_km     -1.334e-02  1.978e-01  -0.067</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))40:distance_km      5.990e-03  1.919e-01   0.031</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))41:distance_km      7.456e-02  2.017e-01   0.370</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))43:distance_km             NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))14:avg_hr_bpm              NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))15:avg_hr_bpm      -2.782e-01  1.389e+00  -0.200</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))16:avg_hr_bpm      -4.800e-02  1.188e-01  -0.404</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))17:avg_hr_bpm      -4.019e-02  2.009e-01  -0.200</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))18:avg_hr_bpm              NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))19:avg_hr_bpm      -3.379e-02  1.875e-01  -0.180</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))21:avg_hr_bpm      -2.646e-02  7.117e-02  -0.372</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))22:avg_hr_bpm       7.164e-03  6.783e-02   0.106</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))23:avg_hr_bpm       4.386e-02  8.661e-02   0.506</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))24:avg_hr_bpm       3.671e-02  7.105e-02   0.517</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))25:avg_hr_bpm       1.050e-01  9.454e-02   1.110</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))26:avg_hr_bpm       1.392e-01  7.541e-02   1.847</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))27:avg_hr_bpm       4.189e-02  1.972e-01   0.212</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))28:avg_hr_bpm       3.029e-02  7.143e-02   0.424</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))29:avg_hr_bpm       7.027e-02  6.379e-02   1.101</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))30:avg_hr_bpm       4.646e-02  7.709e-02   0.603</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))31:avg_hr_bpm      -4.919e-02  5.967e-02  -0.824</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))32:avg_hr_bpm       1.709e-02  6.734e-02   0.254</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))33:avg_hr_bpm       4.439e-02  7.239e-02   0.613</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))34:avg_hr_bpm              NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))35:avg_hr_bpm       2.786e-02  9.976e-02   0.279</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))36:avg_hr_bpm      -1.468e-02  1.264e-01  -0.116</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))37:avg_hr_bpm      -3.462e-02  7.016e-02  -0.493</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))38:avg_hr_bpm      -4.966e-02  7.755e-02  -0.640</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))39:avg_hr_bpm       1.084e-01  9.900e-02   1.095</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))40:avg_hr_bpm      -1.295e-01  1.858e-01  -0.697</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))41:avg_hr_bpm              NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))43:avg_hr_bpm              NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))14:avg_inclination         NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))15:avg_inclination         NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))16:avg_inclination -8.300e+03  4.507e+03  -1.841</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))17:avg_inclination         NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))18:avg_inclination         NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))19:avg_inclination -4.700e+03  5.102e+03  -0.921</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))21:avg_inclination -3.398e+02  3.040e+02  -1.118</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))22:avg_inclination -1.167e+02  2.458e+02  -0.475</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))23:avg_inclination -3.543e+02  4.112e+02  -0.862</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))24:avg_inclination -3.861e+02  5.216e+02  -0.740</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))25:avg_inclination -8.385e+02  7.079e+02  -1.184</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))26:avg_inclination -2.399e+02  2.880e+02  -0.833</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))27:avg_inclination -5.289e+03  3.030e+04  -0.175</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))28:avg_inclination         NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))29:avg_inclination  8.114e+01  2.879e+02   0.282</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))30:avg_inclination -1.315e+02  3.317e+02  -0.397</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))31:avg_inclination -2.751e+01  1.835e+02  -0.150</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))32:avg_inclination -3.697e+02  2.639e+02  -1.401</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))33:avg_inclination  1.019e+01  2.583e+02   0.039</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))34:avg_inclination         NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))35:avg_inclination -7.534e+02  4.309e+03  -0.175</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))36:avg_inclination -7.249e+01  3.743e+02  -0.194</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))37:avg_inclination -1.766e+03  3.178e+03  -0.556</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))38:avg_inclination  2.181e+03  7.739e+03   0.282</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))39:avg_inclination  1.863e+02  2.521e+02   0.739</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))40:avg_inclination  5.615e+02  9.226e+02   0.609</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))41:avg_inclination         NA         NA      NA</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))43:avg_inclination         NA         NA      NA</span></span>
<span><span class="co">#&gt;                                            Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)                                 0.05831 . </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))14                  0.93210   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))15                  0.83061   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))16                  0.00989 **</span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))17                  0.78365   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))18                  0.56627   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))19                  0.53855   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))21                  0.43819   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))22                  0.87352   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))23                  0.94118   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))24                  0.92535   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))25                  0.84163   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))26                  0.20374   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))27                  0.86573   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))28                  0.70295   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))29                  0.45025   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))30                  0.87473   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))31                  0.39935   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))32                  0.72566   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))33                  0.74411   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))34                  0.93039   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))35                  0.92744   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))36                  0.81840   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))37                  0.46202   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))38                  0.91878   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))39                  0.34181   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))40                  0.47051   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))41                  0.87701   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))43                  0.63598   </span></span>
<span><span class="co">#&gt; distance_km                                 0.99207   </span></span>
<span><span class="co">#&gt; avg_hr_bpm                                  0.11391   </span></span>
<span><span class="co">#&gt; avg_inclination                             0.05153 . </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))14:distance_km           NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))15:distance_km      0.91422   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))16:distance_km      0.11719   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))17:distance_km      0.88786   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))18:distance_km      0.55945   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))19:distance_km      0.36623   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))21:distance_km      0.97626   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))22:distance_km      0.98818   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))23:distance_km      0.98793   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))24:distance_km      0.96909   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))25:distance_km      0.90915   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))26:distance_km      0.99632   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))27:distance_km      0.85742   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))28:distance_km      0.99216   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))29:distance_km      0.88273   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))30:distance_km      0.89688   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))31:distance_km      0.98437   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))32:distance_km      0.96649   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))33:distance_km      0.94360   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))34:distance_km      0.93427   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))35:distance_km      0.92583   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))36:distance_km      0.94572   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))37:distance_km      0.61058   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))38:distance_km      0.79237   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))39:distance_km      0.94648   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))40:distance_km      0.97521   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))41:distance_km      0.71303   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))43:distance_km           NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))14:avg_hr_bpm            NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))15:avg_hr_bpm       0.84191   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))16:avg_hr_bpm       0.68769   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))17:avg_hr_bpm       0.84212   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))18:avg_hr_bpm            NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))19:avg_hr_bpm       0.85764   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))21:avg_hr_bpm       0.71145   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))22:avg_hr_bpm       0.91626   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))23:avg_hr_bpm       0.61458   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))24:avg_hr_bpm       0.60744   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))25:avg_hr_bpm       0.27163   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))26:avg_hr_bpm       0.07009 . </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))27:avg_hr_bpm       0.83252   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))28:avg_hr_bpm       0.67312   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))29:avg_hr_bpm       0.27541   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))30:avg_hr_bpm       0.54916   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))31:avg_hr_bpm       0.41327   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))32:avg_hr_bpm       0.80053   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))33:avg_hr_bpm       0.54226   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))34:avg_hr_bpm            NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))35:avg_hr_bpm       0.78109   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))36:avg_hr_bpm       0.90797   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))37:avg_hr_bpm       0.62365   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))38:avg_hr_bpm       0.52450   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))39:avg_hr_bpm       0.27830   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))40:avg_hr_bpm       0.48882   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))41:avg_hr_bpm            NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))43:avg_hr_bpm            NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))14:avg_inclination       NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))15:avg_inclination       NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))16:avg_inclination  0.07087 . </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))17:avg_inclination       NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))18:avg_inclination       NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))19:avg_inclination  0.36091   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))21:avg_inclination  0.26845   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))22:avg_inclination  0.63664   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))23:avg_inclination  0.39263   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))24:avg_inclination  0.46222   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))25:avg_inclination  0.24124   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))26:avg_inclination  0.40844   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))27:avg_inclination  0.86206   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))28:avg_inclination       NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))29:avg_inclination  0.77908   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))30:avg_inclination  0.69319   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))31:avg_inclination  0.88137   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))32:avg_inclination  0.16673   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))33:avg_inclination  0.96866   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))34:avg_inclination       NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))35:avg_inclination  0.86181   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))36:avg_inclination  0.84713   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))37:avg_inclination  0.58066   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))38:avg_inclination  0.77913   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))39:avg_inclination  0.46301   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))40:avg_inclination  0.54523   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))41:avg_inclination       NA   </span></span>
<span><span class="co">#&gt; as.factor(isoweek(date))43:avg_inclination       NA   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.7884 on 56 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8664, Adjusted R-squared:  0.6279 </span></span>
<span><span class="co">#&gt; F-statistic: 3.632 on 100 and 56 DF,  p-value: 3.102e-07</span></span></code></pre>
<p>While the R-squared has again improved (now explaining 86% of the
variance), the diagnostics plots look terrible (see QQ-plot, and
residuals vs. leverage plot), suggesting the same thing mentioned
before: realistically, the model is useless.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_calendar_week_and_more</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/calendar-week-interactions-model-plot-1.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/calendar-week-interactions-model-plot-2.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/calendar-week-interactions-model-plot-3.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/calendar-week-interactions-model-plot-4.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="elasticnet">ElasticNet<a class="anchor" aria-label="anchor" href="#elasticnet"></a>
</h4>
<p>In order to identify which predictors are important, an ElasticNet
fit can be tried. The point to keep in mind here is that the average
inclination is a very important predictor, but the values are very
small, which will result in a rather large model coefficient. Therefore,
to make the other coefficients visible in the trace plot, the
<code>avg_inclination</code> value was scaled by a factor of 100
(i.e. an average inclination of 1 now corresponds to 1% of
inclination).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numerical_track_components</span> <span class="op">&lt;-</span> <span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">date</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">previous_training_date</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">weekday</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">samples</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">altitude_gain_m</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>avg_inclination <span class="op">=</span> <span class="va">avg_inclination</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="co"># scale avg. inclination to %</span></span>
<span></span>
<span><span class="va">training_set_ratio</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">training_set_indices</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">numerical_track_components</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">numerical_track_components</span><span class="op">)</span> <span class="op">*</span> <span class="va">training_set_ratio</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">training_set</span> <span class="op">&lt;-</span> <span class="va">numerical_track_components</span><span class="op">[</span><span class="va">training_set_indices</span>,<span class="op">]</span></span>
<span><span class="va">test_set</span> <span class="op">&lt;-</span> <span class="va">numerical_track_components</span><span class="op">[</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">numerical_track_components</span><span class="op">)</span>, <span class="va">training_set_indices</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># glmnet mixing param (hyperparameter; should be tuned instead of hard-coded)</span></span>
<span><span class="co"># for now: alpha = 1, i.e. Lasso regression (0 = Ridge; 0 &lt; alpha &lt; 1 = mixed)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">fit_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">training_set</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">speed_km_h</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="va">training_set</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">speed_km_h</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">cv_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">training_set</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">speed_km_h</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="va">training_set</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">speed_km_h</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_glm</span>, xvar <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/glmnet-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_glm</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/glmnet-2.png" width="384" style="display: block; margin: auto;"></p>
<p>As can be seen, with a Lasso regression, the algorithm will create a
model using 11 predictors (and an intercept) for both the 1 SE
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
and for the minimum MSE
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_glm</span>, <span class="va">cv_glm</span><span class="op">$</span><span class="va">lambda.1se</span><span class="op">)</span></span>
<span><span class="co">#&gt; 13 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;                                        s1</span></span>
<span><span class="co">#&gt; (Intercept)                  24.544688191</span></span>
<span><span class="co">#&gt; distance_km                   0.222572784</span></span>
<span><span class="co">#&gt; time_min                     -0.096183174</span></span>
<span><span class="co">#&gt; avg_inclination              -3.157811718</span></span>
<span><span class="co">#&gt; temperature_c                -0.010519095</span></span>
<span><span class="co">#&gt; avg_hr_bpm                    0.051116808</span></span>
<span><span class="co">#&gt; below_zones_min               0.017428942</span></span>
<span><span class="co">#&gt; zone1_min                    -0.028204552</span></span>
<span><span class="co">#&gt; zone2_min                    -0.010900509</span></span>
<span><span class="co">#&gt; zone3_min                     .          </span></span>
<span><span class="co">#&gt; zone4_min                    -0.035141159</span></span>
<span><span class="co">#&gt; above_zones_min              -0.226121274</span></span>
<span><span class="co">#&gt; days_since_previous_training -0.001913364</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_glm</span>, <span class="va">cv_glm</span><span class="op">$</span><span class="va">lambda.min</span><span class="op">)</span></span>
<span><span class="co">#&gt; 13 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;                                        s1</span></span>
<span><span class="co">#&gt; (Intercept)                  23.174671976</span></span>
<span><span class="co">#&gt; distance_km                   0.312168642</span></span>
<span><span class="co">#&gt; time_min                     -0.140060373</span></span>
<span><span class="co">#&gt; avg_inclination              -2.829044363</span></span>
<span><span class="co">#&gt; temperature_c                -0.007161805</span></span>
<span><span class="co">#&gt; avg_hr_bpm                    0.056357324</span></span>
<span><span class="co">#&gt; below_zones_min               0.037595273</span></span>
<span><span class="co">#&gt; zone1_min                    -0.016642557</span></span>
<span><span class="co">#&gt; zone2_min                    -0.006091218</span></span>
<span><span class="co">#&gt; zone3_min                     .          </span></span>
<span><span class="co">#&gt; zone4_min                    -0.028929052</span></span>
<span><span class="co">#&gt; above_zones_min              -0.190123416</span></span>
<span><span class="co">#&gt; days_since_previous_training -0.001988406</span></span></code></pre></div>
<p>However, in both models there are a lot of variables that are
probably relatively strongly correlated (e.g. all the heart rate
variables, or the time and distance variables):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">numerical_track_components</span><span class="op">)</span></span>
<span><span class="co">#&gt;                              distance_km    time_min avg_inclination</span></span>
<span><span class="co">#&gt; distance_km                   1.00000000  0.99474215      0.33422876</span></span>
<span><span class="co">#&gt; time_min                      0.99474215  1.00000000      0.37183666</span></span>
<span><span class="co">#&gt; avg_inclination               0.33422876  0.37183666      1.00000000</span></span>
<span><span class="co">#&gt; temperature_c                -0.19636208 -0.18316844     -0.07903338</span></span>
<span><span class="co">#&gt; speed_km_h                   -0.32500914 -0.40933582     -0.59341356</span></span>
<span><span class="co">#&gt; avg_hr_bpm                   -0.03815031 -0.08038793      0.08161380</span></span>
<span><span class="co">#&gt; below_zones_min               0.40972476  0.45401028      0.23265284</span></span>
<span><span class="co">#&gt; zone1_min                     0.54084746  0.59348768      0.20371427</span></span>
<span><span class="co">#&gt; zone2_min                     0.86476066  0.88317090      0.23984065</span></span>
<span><span class="co">#&gt; zone3_min                     0.84223292  0.81063842      0.30831494</span></span>
<span><span class="co">#&gt; zone4_min                     0.22653389  0.21070544      0.28612873</span></span>
<span><span class="co">#&gt; above_zones_min              -0.04612616 -0.04857525     -0.03472193</span></span>
<span><span class="co">#&gt; days_since_previous_training          NA          NA              NA</span></span>
<span><span class="co">#&gt;                              temperature_c  speed_km_h  avg_hr_bpm</span></span>
<span><span class="co">#&gt; distance_km                    -0.19636208 -0.32500914 -0.03815031</span></span>
<span><span class="co">#&gt; time_min                       -0.18316844 -0.40933582 -0.08038793</span></span>
<span><span class="co">#&gt; avg_inclination                -0.07903338 -0.59341356  0.08161380</span></span>
<span><span class="co">#&gt; temperature_c                   1.00000000 -0.02038533  0.01996374</span></span>
<span><span class="co">#&gt; speed_km_h                     -0.02038533  1.00000000  0.42046295</span></span>
<span><span class="co">#&gt; avg_hr_bpm                      0.01996374  0.42046295  1.00000000</span></span>
<span><span class="co">#&gt; below_zones_min                -0.04451513 -0.50554421 -0.64326362</span></span>
<span><span class="co">#&gt; zone1_min                      -0.06514123 -0.64175561 -0.69347190</span></span>
<span><span class="co">#&gt; zone2_min                      -0.11765521 -0.45588197 -0.36525954</span></span>
<span><span class="co">#&gt; zone3_min                      -0.19647189 -0.04905263  0.38113546</span></span>
<span><span class="co">#&gt; zone4_min                      -0.08662956  0.01870542  0.60010805</span></span>
<span><span class="co">#&gt; above_zones_min                -0.08093673  0.05433833  0.08594706</span></span>
<span><span class="co">#&gt; days_since_previous_training            NA          NA          NA</span></span>
<span><span class="co">#&gt;                              below_zones_min   zone1_min   zone2_min</span></span>
<span><span class="co">#&gt; distance_km                       0.40972476  0.54084746  0.86476066</span></span>
<span><span class="co">#&gt; time_min                          0.45401028  0.59348768  0.88317090</span></span>
<span><span class="co">#&gt; avg_inclination                   0.23265284  0.20371427  0.23984065</span></span>
<span><span class="co">#&gt; temperature_c                    -0.04451513 -0.06514123 -0.11765521</span></span>
<span><span class="co">#&gt; speed_km_h                       -0.50554421 -0.64175561 -0.45588197</span></span>
<span><span class="co">#&gt; avg_hr_bpm                       -0.64326362 -0.69347190 -0.36525954</span></span>
<span><span class="co">#&gt; below_zones_min                   1.00000000  0.71443392  0.54494475</span></span>
<span><span class="co">#&gt; zone1_min                         0.71443392  1.00000000  0.74403267</span></span>
<span><span class="co">#&gt; zone2_min                         0.54494475  0.74403267  1.00000000</span></span>
<span><span class="co">#&gt; zone3_min                         0.03826689  0.05621131  0.51743968</span></span>
<span><span class="co">#&gt; zone4_min                        -0.30409360 -0.28628642 -0.15452658</span></span>
<span><span class="co">#&gt; above_zones_min                  -0.08918284 -0.08251139 -0.07327457</span></span>
<span><span class="co">#&gt; days_since_previous_training              NA          NA          NA</span></span>
<span><span class="co">#&gt;                                 zone3_min   zone4_min above_zones_min</span></span>
<span><span class="co">#&gt; distance_km                   0.842232922  0.22653389    -0.046126156</span></span>
<span><span class="co">#&gt; time_min                      0.810638425  0.21070544    -0.048575248</span></span>
<span><span class="co">#&gt; avg_inclination               0.308314942  0.28612873    -0.034721934</span></span>
<span><span class="co">#&gt; temperature_c                -0.196471886 -0.08662956    -0.080936727</span></span>
<span><span class="co">#&gt; speed_km_h                   -0.049052633  0.01870542     0.054338334</span></span>
<span><span class="co">#&gt; avg_hr_bpm                    0.381135465  0.60010805     0.085947055</span></span>
<span><span class="co">#&gt; below_zones_min               0.038266888 -0.30409360    -0.089182836</span></span>
<span><span class="co">#&gt; zone1_min                     0.056211313 -0.28628642    -0.082511390</span></span>
<span><span class="co">#&gt; zone2_min                     0.517439678 -0.15452658    -0.073274567</span></span>
<span><span class="co">#&gt; zone3_min                     1.000000000  0.40167975    -0.009046145</span></span>
<span><span class="co">#&gt; zone4_min                     0.401679752  1.00000000     0.078953318</span></span>
<span><span class="co">#&gt; above_zones_min              -0.009046145  0.07895332     1.000000000</span></span>
<span><span class="co">#&gt; days_since_previous_training           NA          NA              NA</span></span>
<span><span class="co">#&gt;                              days_since_previous_training</span></span>
<span><span class="co">#&gt; distance_km                                            NA</span></span>
<span><span class="co">#&gt; time_min                                               NA</span></span>
<span><span class="co">#&gt; avg_inclination                                        NA</span></span>
<span><span class="co">#&gt; temperature_c                                          NA</span></span>
<span><span class="co">#&gt; speed_km_h                                             NA</span></span>
<span><span class="co">#&gt; avg_hr_bpm                                             NA</span></span>
<span><span class="co">#&gt; below_zones_min                                        NA</span></span>
<span><span class="co">#&gt; zone1_min                                              NA</span></span>
<span><span class="co">#&gt; zone2_min                                              NA</span></span>
<span><span class="co">#&gt; zone3_min                                              NA</span></span>
<span><span class="co">#&gt; zone4_min                                              NA</span></span>
<span><span class="co">#&gt; above_zones_min                                        NA</span></span>
<span><span class="co">#&gt; days_since_previous_training                            1</span></span></code></pre></div>
<p>What would happen if we eliminate <code>time_min</code> and keep only
<code>avg_hr_bpm</code> for the heart rate variables?</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numerical_track_components_reduced</span> <span class="op">&lt;-</span> <span class="va">numerical_track_components</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">time_min</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">below_zones_min</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">zone1_min</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">zone2_min</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">zone3_min</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">zone4_min</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">above_zones_min</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># same training/test set split and alpha as for the larger glmnet model</span></span>
<span><span class="va">training_set_reduced</span> <span class="op">&lt;-</span> <span class="va">numerical_track_components_reduced</span><span class="op">[</span><span class="va">training_set_indices</span>,<span class="op">]</span></span>
<span><span class="va">test_set_reduced</span> <span class="op">&lt;-</span> <span class="va">numerical_track_components_reduced</span><span class="op">[</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">numerical_track_components_reduced</span><span class="op">)</span>, <span class="va">training_set_indices</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">fit_glm_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html" class="external-link">glmnet</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">training_set_reduced</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">speed_km_h</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="va">training_set_reduced</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">speed_km_h</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">cv_glm_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">training_set_reduced</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">speed_km_h</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="va">training_set_reduced</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">speed_km_h</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/proxy/man/dist.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_glm_reduced</span>, xvar <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/glmnet-reduced-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cv_glm_reduced</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/glmnet-reduced-2.png" width="384" style="display: block; margin: auto;">
We now get a model with 5 (or 3) parameters for minimum (or 1se) lambda,
i.e. the minimum MSE lambda will use all available predictors (distance,
inclination, temperature, average heart rate, and days since last
training), whereas the 1se lambda will ignore the temperature and days
since last training effects:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_glm_reduced</span>, <span class="va">cv_glm_reduced</span><span class="op">$</span><span class="va">lambda.min</span><span class="op">)</span></span>
<span><span class="co">#&gt; 6 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;                                        s1</span></span>
<span><span class="co">#&gt; (Intercept)                  21.388765335</span></span>
<span><span class="co">#&gt; distance_km                  -0.011019946</span></span>
<span><span class="co">#&gt; avg_inclination              -4.244095168</span></span>
<span><span class="co">#&gt; temperature_c                -0.010307268</span></span>
<span><span class="co">#&gt; avg_hr_bpm                    0.081755859</span></span>
<span><span class="co">#&gt; days_since_previous_training -0.001526533</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_glm_reduced</span>, <span class="va">cv_glm_reduced</span><span class="op">$</span><span class="va">lambda.1se</span><span class="op">)</span></span>
<span><span class="co">#&gt; 6 x 1 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;                                       s1</span></span>
<span><span class="co">#&gt; (Intercept)                  22.62977386</span></span>
<span><span class="co">#&gt; distance_km                  -0.00551085</span></span>
<span><span class="co">#&gt; avg_inclination              -3.63267457</span></span>
<span><span class="co">#&gt; temperature_c                 .         </span></span>
<span><span class="co">#&gt; avg_hr_bpm                    0.06552551</span></span>
<span><span class="co">#&gt; days_since_previous_training  .</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="random-effects-models">Random Effects Models<a class="anchor" aria-label="anchor" href="#random-effects-models"></a>
</h4>
<p>Since fitness levels could fluctuate between years (different loss of
fitness during the winter, increasing age, and other influences), adding
random effects might be another thing to try. As a baseline, a linear
model with fixed effects for distance, inclination, and heart rate was
chosen, which seems the most appropriate after what we’ve seen in the
previous sections. The first idea was to use a random effect for the
year, and maybe a nested random effect for months. After the tracks were
labelled (see “Clustering” and “Route-specific Linear Models” sections),
models with a random effect for the route and a 2-level model with a
random effect for years and a nested effect for route were also
tried:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks_year_month</span> <span class="op">&lt;-</span> <span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">track_classes</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">track</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/gls.html" class="external-link">gls</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">distance_km</span> <span class="op">+</span> <span class="va">avg_inclination</span> <span class="op">+</span> <span class="va">avg_hr_bpm</span>, data <span class="op">=</span> <span class="va">tracks_year_month</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_random_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">distance_km</span> <span class="op">+</span> <span class="va">avg_inclination</span> <span class="op">+</span> <span class="va">avg_hr_bpm</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">year</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tracks_year_month</span><span class="op">)</span></span>
<span><span class="va">fit_random_year_month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">distance_km</span> <span class="op">+</span> <span class="va">avg_inclination</span> <span class="op">+</span> <span class="va">avg_hr_bpm</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">year</span><span class="op">/</span><span class="va">month</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tracks_year_month</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_random_track</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">distance_km</span> <span class="op">+</span> <span class="va">avg_inclination</span> <span class="op">+</span> <span class="va">avg_hr_bpm</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">track</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tracks_year_month</span><span class="op">)</span></span>
<span><span class="va">fit_random_year_track</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html" class="external-link">lme</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">distance_km</span> <span class="op">+</span> <span class="va">avg_inclination</span> <span class="op">+</span> <span class="va">avg_hr_bpm</span>,</span>
<span>  random <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">year</span><span class="op">/</span><span class="va">track</span>,</span>
<span>  data <span class="op">=</span> <span class="va">tracks_year_month</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_baseline</span>, <span class="va">fit_random_year</span>, <span class="va">fit_random_year_month</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       Model df      AIC      BIC    logLik   Test   L.Ratio</span></span>
<span><span class="co">#&gt; fit_baseline              1  5 384.7310 399.6147 -187.3655                 </span></span>
<span><span class="co">#&gt; fit_random_year           2  6 358.1971 376.0575 -173.0985 1 vs 2 28.533958</span></span>
<span><span class="co">#&gt; fit_random_year_month     3  7 352.7764 373.6135 -169.3882 2 vs 3  7.420717</span></span>
<span><span class="co">#&gt;                       p-value</span></span>
<span><span class="co">#&gt; fit_baseline                 </span></span>
<span><span class="co">#&gt; fit_random_year        &lt;.0001</span></span>
<span><span class="co">#&gt; fit_random_year_month  0.0064</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_baseline</span>, <span class="va">fit_random_year</span>, <span class="va">fit_random_year_track</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       Model df      AIC      BIC    logLik   Test   L.Ratio</span></span>
<span><span class="co">#&gt; fit_baseline              1  5 384.7310 399.6147 -187.3655                 </span></span>
<span><span class="co">#&gt; fit_random_year           2  6 358.1971 376.0575 -173.0985 1 vs 2 28.533958</span></span>
<span><span class="co">#&gt; fit_random_year_track     3  7 352.7737 373.6109 -169.3869 2 vs 3  7.423347</span></span>
<span><span class="co">#&gt;                       p-value</span></span>
<span><span class="co">#&gt; fit_baseline                 </span></span>
<span><span class="co">#&gt; fit_random_year        &lt;.0001</span></span>
<span><span class="co">#&gt; fit_random_year_track  0.0064</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_baseline</span>, <span class="va">fit_random_track</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  Model df      AIC      BIC    logLik   Test L.Ratio p-value</span></span>
<span><span class="co">#&gt; fit_baseline         1  5 384.7310 399.6147 -187.3655                       </span></span>
<span><span class="co">#&gt; fit_random_track     2  6 384.5631 402.4235 -186.2816 1 vs 2 2.16791  0.1409</span></span></code></pre></div>
<p>Comparing the models, we see that adding a random effect for the
route (<code>fit_random_track</code>) is not better than the fixed
baseline model alone. However, adding a random effect for the year
results in a better model, with the multi-level models with nested
effects for month or track being even better.</p>
<p>However, the random effects are rather small, for example, in the
nested year/month model, the standard deviations for the random year and
month effects are less than 0.6 and 0.3, respectively, with a standard
deviation of the residual errors of almost 0.7:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_random_year_month</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed-effects model fit by REML</span></span>
<span><span class="co">#&gt;   Data: tracks_year_month </span></span>
<span><span class="co">#&gt;        AIC      BIC    logLik</span></span>
<span><span class="co">#&gt;   352.7764 373.6135 -169.3882</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Formula: ~1 | year</span></span>
<span><span class="co">#&gt;         (Intercept)</span></span>
<span><span class="co">#&gt; StdDev:   0.6237785</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Formula: ~1 | month %in% year</span></span>
<span><span class="co">#&gt;         (Intercept)  Residual</span></span>
<span><span class="co">#&gt; StdDev:   0.3546791 0.6572115</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:  speed_km_h ~ distance_km + avg_inclination + avg_hr_bpm </span></span>
<span><span class="co">#&gt;                     Value Std.Error  DF    t-value p-value</span></span>
<span><span class="co">#&gt; (Intercept)       24.0425   1.60039 117  15.022919  0.0000</span></span>
<span><span class="co">#&gt; distance_km       -0.0137   0.00421 117  -3.265322  0.0014</span></span>
<span><span class="co">#&gt; avg_inclination -422.7348  40.81293 117 -10.357865  0.0000</span></span>
<span><span class="co">#&gt; avg_hr_bpm         0.0605   0.01074 117   5.627163  0.0000</span></span>
<span><span class="co">#&gt;  Correlation: </span></span>
<span><span class="co">#&gt;                 (Intr) dstnc_ avg_nc</span></span>
<span><span class="co">#&gt; distance_km      0.074              </span></span>
<span><span class="co">#&gt; avg_inclination -0.166 -0.391       </span></span>
<span><span class="co">#&gt; avg_hr_bpm      -0.950 -0.062 -0.082</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Within-Group Residuals:</span></span>
<span><span class="co">#&gt;        Min         Q1        Med         Q3        Max </span></span>
<span><span class="co">#&gt; -2.4187433 -0.6322553 -0.0592517  0.5322350  3.1249577 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Observations: 149</span></span>
<span><span class="co">#&gt; Number of Groups: </span></span>
<span><span class="co">#&gt;            year month %in% year </span></span>
<span><span class="co">#&gt;               6              29</span></span></code></pre></div>
<p>Note that only the most basic random effects were tried so far
(i.e. random intercepts), what could also be worth investigating is
adding random slopes, e.g. fitting a model that has a random effect for
the average heart rate, depending on the year. This has so far not been
explored further, due to time constraints.</p>
</div>
</div>
<div class="section level3">
<h3 id="pca">PCA<a class="anchor" aria-label="anchor" href="#pca"></a>
</h3>
<p>To get an impression of which variables are important, we can do a
principal component analysis:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numerical_track_components_pca</span> <span class="op">&lt;-</span> <span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>weekday <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">weekday</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">date</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">previous_training_date</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">numerical_track_components_pca</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pca</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="st">"pcs"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC</span>, y <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PC"</span>, y <span class="op">=</span> <span class="st">"Explained Variance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-scree-plot-1.png" width="384" style="display: block; margin: auto;"></p>
<p>As can be seen from the scree plot, the first two principal
components explain almost 60% of the total variance in the data, with
the next five principal components still explaining between 5 and 10
percent each, and each of the last six components explaining less than
5% of the total variance.</p>
<p>Looking at some bi-plots for some combinations of the first seven
components, we can get a feeling for what the components mean:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-2.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-3.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">5</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-4.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">6</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-5.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">7</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-6.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-7.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-8.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html" class="external-link">biplot</a></span><span class="op">(</span><span class="va">pca</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/pca-biplot-9.png" width="384" style="display: block; margin: auto;"></p>
<p>The two most important components seem to correspond mostly to
distance/altitude/inclination-related variables (PC1), and to heart
rate-related variables (PC2), which is not really surprising, seeing how
these are also the relevant predictors seen e.g. in the linear
models.</p>
<p>What is striking, though, is the relatively clean grouping of data
points in the bi-plot of the first two components, which warrants
further investigation.</p>
</div>
<div class="section level3">
<h3 id="clustering">Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h3>
<p>After the clusters observed in the PCA biplot, the next question is
if clustering reveals anything interesting.</p>
<p>First, some data preparation: for clustering, we need numeric data,
without <code>NA</code> values, and variables should be on the same
scale.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scaled_tracks</span> <span class="op">&lt;-</span> <span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>weekday <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">weekday</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">date</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">previous_training_date</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">samples</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The first approach then is a Gaussian mixture model:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clusters_gaussian_mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></span><span class="op">(</span><span class="va">scaled_tracks</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">clusters_gaussian_mix</span>, what <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/cluster-gaussian-mix-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Since the plot matrix is somewhat hard to read, let’s plot track
distance vs speed, colored by clusters:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scaled_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">clusters_gaussian_mix</span><span class="op">$</span><span class="va">classification</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance_km</span>, y <span class="op">=</span> <span class="va">speed_km_h</span>, color <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Standardized Distance"</span>, y <span class="op">=</span> <span class="st">"Standardized Speed"</span>, color <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Gaussian Mixture Model Clustering"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/cluster-gaussian-mix-plot-1.png" width="384" style="display: block; margin: auto;"></p>
<p>It appears the Gaussian mixture model seems to have clustered the
data primarily by track length.</p>
<p>Maybe a different clustering algorithm finds some other classes?
Let’s try density-based spatial clustering. To find good clustering
parameters, we start with a low <code>minPts</code> value, and try out
some values for <code>eps</code> that seem promising from the
k-nearest-neighbor-distance-plot:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/kNNdist.html" class="external-link">kNNdistplot</a></span><span class="op">(</span><span class="va">scaled_tracks</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">2.1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.5</span>, col <span class="op">=</span> <span class="st">"blue"</span>,lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">2.55</span>, col <span class="op">=</span> <span class="st">"blue"</span>,lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">3.25</span>, col <span class="op">=</span> <span class="st">"blue"</span>,lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">4.1</span>, col <span class="op">=</span> <span class="st">"blue"</span>,lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/cluster-dbscan-prep-1.png" width="384" style="display: block; margin: auto;"></p>
<p><code>k = 1</code> corresponds to a <code>minPts</code> value of 2,
and the values for the <code>abline</code>s in the plot were tried out.
The red line (corresponding to a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ε</mi><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math>,
i.e. an <code>eps</code> value, of 2.1) results in three clusters (and a
fourth group for “noise” data points):</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clusters_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html" class="external-link">dbscan</a></span><span class="op">(</span><span class="va">scaled_tracks</span>, eps <span class="op">=</span> <span class="fl">2.1</span>, minPts <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scaled_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">clusters_db</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">distance_km</span>, y <span class="op">=</span> <span class="va">speed_km_h</span>, color <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Standardized Distance"</span>, y <span class="op">=</span> <span class="st">"Standardized Speed"</span>, color <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Density-Based Spatial Clustering"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/cluster-dbscan-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Higher density values (i.e. higher values for the <code>eps</code>
parameter, and higher values for <code>k</code> in the k-NN plot) need
different <code>eps</code> values, however, during experimenting with
different <code>k</code> (and thus <code>minPts</code>) values, as well
as different <code>eps</code> values has only resulted in fewer
clusters, most of the time only one “real” and one noise cluster. Even
with the three clusters above, we see again a classification that seems
to be mostly based on track distance.</p>
</div>
<div class="section level3">
<h3 id="route-specific-linear-models">Route-specific Linear Models<a class="anchor" aria-label="anchor" href="#route-specific-linear-models"></a>
</h3>
<p>After the results of the clustering attempts (and some discussions
during the intermediate presentation), the tracks were manually
classified, based on the route driven, and (for one particular route)
also the direction in which the route was driven (all other routes were
only ever driven in one direction).</p>
<p>This should result in much better comparability for tracks from the
same group, since differences among routes (that cannot easily be
gleaned from the data) can be eliminated by just comparing tracks using
the same route.</p>
<p>With that, let’s try fitting a linear model again, but this time a
route-specific one. We’ll arbitrarily pick tracks 1, 2, and 4 (about 25,
40, and 60 kilometers, respectively) for modelling.</p>
<p>To get a better sense for the chosen tracks: the chosen tracks are
the purple, blue, and green tracks on the following map:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">track_linestrings</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">track_classes</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">track</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"turbo"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Selecting the tracks:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">labeled_tracks</span> <span class="op">&lt;-</span> <span class="va">corrected_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">track_classes</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tracks_1</span> <span class="op">&lt;-</span> <span class="va">labeled_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">track</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tracks_2</span> <span class="op">&lt;-</span> <span class="va">labeled_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">track</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">tracks_4</span> <span class="op">&lt;-</span> <span class="va">labeled_tracks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">track</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>Since the route is now always the same for tracks of the same group,
the distance and inclination is always the same, and therefore won’t be
able to predict variations in speed. Thus, let’s try a model using heart
rate and temperature:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_track_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">avg_hr_bpm</span> <span class="op">+</span> <span class="va">temperature_c</span>, data <span class="op">=</span> <span class="va">tracks_1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_track_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ avg_hr_bpm + temperature_c, data = tracks_1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.13855 -0.51188 -0.06761  0.34820  2.29499 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   18.71064    1.71732  10.895 4.95e-15 ***</span></span>
<span><span class="co">#&gt; avg_hr_bpm     0.06522    0.01192   5.473 1.29e-06 ***</span></span>
<span><span class="co">#&gt; temperature_c  0.03112    0.03086   1.008    0.318    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.721 on 52 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.4011, Adjusted R-squared:  0.3781 </span></span>
<span><span class="co">#&gt; F-statistic: 17.41 on 2 and 52 DF,  p-value: 1.627e-06</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_track_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-5-2.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-5-3.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-5-4.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_track_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">avg_hr_bpm</span> <span class="op">+</span> <span class="va">temperature_c</span>, data <span class="op">=</span> <span class="va">tracks_2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_track_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ avg_hr_bpm + temperature_c, data = tracks_2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.31001 -0.06857  0.05155  0.12025  0.24216 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   17.06636    2.02651   8.422 6.56e-05 ***</span></span>
<span><span class="co">#&gt; avg_hr_bpm     0.07855    0.01511   5.198  0.00126 ** </span></span>
<span><span class="co">#&gt; temperature_c -0.03064    0.02948  -1.039  0.33326    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2064 on 7 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7946, Adjusted R-squared:  0.7359 </span></span>
<span><span class="co">#&gt; F-statistic: 13.54 on 2 and 7 DF,  p-value: 0.003928</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_track_2</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-6-2.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-6-3.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-6-4.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_track_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">avg_hr_bpm</span> <span class="op">+</span> <span class="va">temperature_c</span>, data <span class="op">=</span> <span class="va">tracks_4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_track_4</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ avg_hr_bpm + temperature_c, data = tracks_4)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.4289 -0.4170  0.1001  0.6196  1.4331 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   11.65598    2.63503   4.423 5.40e-05 ***</span></span>
<span><span class="co">#&gt; avg_hr_bpm     0.10733    0.01654   6.489 4.11e-08 ***</span></span>
<span><span class="co">#&gt; temperature_c  0.00604    0.03664   0.165     0.87    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8631 on 49 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.4682, Adjusted R-squared:  0.4465 </span></span>
<span><span class="co">#&gt; F-statistic: 21.57 on 2 and 49 DF,  p-value: 1.908e-07</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_track_4</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/unnamed-chunk-7-1.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-7-2.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-7-3.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-7-4.png" width="384" style="display: block; margin: auto;"></p>
<p>For all of the three routes, we see that the temperature has no
significant effect. Again, we could try to find a training effect during
the course of the season, however, for the selected tracks we now have
fewer data points per route: only 10 tracks in group 2, and while tracks
in groups 1 and 4 have 55 and 52 observations, the observations for
group 4 are almost all in the later part of the season, which is not
great for modeling:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks_1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/unnamed-chunk-8-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks_4</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/unnamed-chunk-8-2.png" width="384" style="display: block; margin: auto;"></p>
<p>The class 1 tracks only have 3 observations in October, but overall
the number of available data points for this group looks better, so
let’s try to create a model for this group:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks_1_speed_month</span> <span class="op">&lt;-</span> <span class="va">tracks_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">speed_km_h</span>, <span class="va">month</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_tracks_1_month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">speed_km_h</span> <span class="op">~</span> <span class="va">month</span>, data <span class="op">=</span> <span class="va">tracks_1_speed_month</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_tracks_1_month</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = speed_km_h ~ month, data = tracks_1_speed_month)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.56163 -0.49759 -0.05842  0.58971  1.77622 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 28.98822    0.28323 102.348   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; month5       0.01964    0.36845   0.053    0.958    </span></span>
<span><span class="co">#&gt; month6      -0.90112    0.41288  -2.183    0.034 *  </span></span>
<span><span class="co">#&gt; month7      -0.02002    0.47394  -0.042    0.966    </span></span>
<span><span class="co">#&gt; month8       0.49069    0.41288   1.188    0.240    </span></span>
<span><span class="co">#&gt; month9      -0.32493    0.40055  -0.811    0.421    </span></span>
<span><span class="co">#&gt; month10     -0.91418    0.56646  -1.614    0.113    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8497 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2322, Adjusted R-squared:  0.1362 </span></span>
<span><span class="co">#&gt; F-statistic: 2.419 on 6 and 48 DF,  p-value: 0.04008</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_tracks_1_month</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-9-2.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-9-3.png" width="384" style="display: block; margin: auto;"><img src="analyses_files/figure-html/unnamed-chunk-9-4.png" width="384" style="display: block; margin: auto;"></p>
<p>Again, no significant effect can be found. Considering that the model
using heart rate and temperature explained only 40% of the variance, and
without an obvious training effect over the course of the season, there
are probably factors influencing the average speed that are not
available in the data. This could be environmental factors (e.g. wind),
or fitness-related factors (e.g. influences of other trainings that were
not recorded). In any case, the available data seems insufficient to
accurately predict the average speed for a track, with the only somewhat
certain statement seeming “higher average heart rate (i.e. higher
training effort) correlates with higher average speed”, which seems
logical, even without looking at the data.</p>
</div>
<div class="section level3">
<h3 id="dynamic-time-warping">Dynamic Time Warping<a class="anchor" aria-label="anchor" href="#dynamic-time-warping"></a>
</h3>
<p>Another technique suggested during the discussion after the mid-term
presentation is dynamic time warping. Tracks along the same route could
be time-warped, and the resulting mappings could then be analyzed to
find parts of the route that have low or high variation among
tracks.</p>
<p>Due to time constraints, this is not finished yet, it is still very
much work in progress.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks_1_fastest</span> <span class="op">&lt;-</span> <span class="va">tracks_1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">time_min</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="va">tracks_1_slowest</span> <span class="op">&lt;-</span> <span class="va">tracks_1</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span><span class="va">time_min</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t1f</span> <span class="op">&lt;-</span> <span class="va">track_details</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks_1_fastest</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span></span>
<span><span class="va">t1s</span> <span class="op">&lt;-</span> <span class="va">track_details</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks_1_slowest</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dtw/man/dtw.html" class="external-link">dtw</a></span><span class="op">(</span><span class="va">t1s</span>, <span class="va">t1f</span>, keep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a</span>, type <span class="op">=</span> <span class="st">"alignment"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/dynamic-time-warp-1-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a</span>, type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/dynamic-time-warp-1-2.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot(a, type = "two", offset = -200)</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks_2_fastest</span> <span class="op">&lt;-</span> <span class="va">tracks_2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">time_min</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="va">tracks_2_slowest</span> <span class="op">&lt;-</span> <span class="va">tracks_2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span><span class="va">time_min</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t2f</span> <span class="op">&lt;-</span> <span class="va">track_details</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks_2_fastest</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span></span>
<span><span class="va">t2s</span> <span class="op">&lt;-</span> <span class="va">track_details</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks_2_slowest</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dtw/man/dtw.html" class="external-link">dtw</a></span><span class="op">(</span><span class="va">t2s</span>, <span class="va">t2f</span>, keep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, type <span class="op">=</span> <span class="st">"alignment"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/dynamic-time-warp-2-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/dynamic-time-warp-2-2.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot(a, type = "two", offset = -200)</span></span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tracks_4_fastest</span> <span class="op">&lt;-</span> <span class="va">tracks_4</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">time_min</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="va">tracks_4_slowest</span> <span class="op">&lt;-</span> <span class="va">tracks_4</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span><span class="va">time_min</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t4f</span> <span class="op">&lt;-</span> <span class="va">track_details</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks_4_fastest</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span></span>
<span><span class="va">t4s</span> <span class="op">&lt;-</span> <span class="va">track_details</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="va">tracks_4_slowest</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dtw/man/dtw.html" class="external-link">dtw</a></span><span class="op">(</span><span class="va">t4s</span>, <span class="va">t4f</span>, keep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c</span>, type <span class="op">=</span> <span class="st">"alignment"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/dynamic-time-warp-4-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c</span>, type <span class="op">=</span> <span class="st">"density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyses_files/figure-html/dynamic-time-warp-4-2.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#plot(a, type = "two", offset = -200)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nils S..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
